<Window
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:HashForge"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Hash Forge" Height="700" Width="1120"
        MinWidth="900" MinHeight="600"
        WindowStyle="None" AllowsTransparency="True" Background="Transparent"
        ResizeMode="CanResizeWithGrip"
        WindowStartupLocation="CenterScreen">

    <WindowChrome.WindowChrome>
        <WindowChrome CaptionHeight="40" ResizeBorderThickness="8" GlassFrameThickness="0" CornerRadius="0"/>
    </WindowChrome.WindowChrome>

    <Window.Resources>
         <SolidColorBrush x:Key="BackgroundBrush" Color="#050b16"/>
         <SolidColorBrush x:Key="CardBrush" Color="#111a2b"/>
         <SolidColorBrush x:Key="TextBrush" Color="#f8fafc"/>
         <SolidColorBrush x:Key="PrimaryBrush" Color="#00c2ff"/>
         <SolidColorBrush x:Key="AccentBrush" Color="#34e0a1"/>
         <SolidColorBrush x:Key="DangerBrush" Color="#ff7b00"/>
         
         <Style TargetType="Button">
            <Setter Property="Background" Value="#1e293b"/>
            <Setter Property="Foreground" Value="{StaticResource TextBrush}"/>
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="6" 
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Opacity" Value="0.9"/>
                                <Setter Property="Cursor" Value="Hand"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
         </Style>

         <!-- ComboBox Item Style -->
         <Style TargetType="ComboBoxItem">
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="Padding" Value="12,10"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBoxItem">
                        <Border x:Name="bd" Background="{TemplateBinding Background}" BorderThickness="0,0,0,0" Padding="{TemplateBinding Padding}" SnapsToDevicePixels="True">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="4"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Border x:Name="Indicator" Background="Transparent" CornerRadius="2" Margin="0,2,0,2"/>
                                <ContentPresenter Grid.Column="1" Margin="8,0,0,0" 
                                                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" 
                                                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="bd" Property="Background" Value="#1effffff"/>
                                <Setter Property="Cursor" Value="Hand"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="bd" Property="Background" Value="#2600c2ff"/>
                                <Setter TargetName="Indicator" Property="Background" Value="{StaticResource PrimaryBrush}"/>
                                <Setter Property="Foreground" Value="White"/>
                                <Setter Property="FontWeight" Value="SemiBold"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
         </Style>

         <!-- ComboBox Style -->
         <Style TargetType="ComboBox">
            <Setter Property="Foreground" Value="{StaticResource TextBrush}"/>
            <Setter Property="Background" Value="#111a2b"/>
            <Setter Property="BorderBrush" Value="#33ffffff"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="12,6"/>
            <Setter Property="Height" Value="34"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Grid>
                            <ToggleButton Name="ToggleButton" 
                                          Focusable="false" 
                                          IsChecked="{Binding Path=IsDropDownOpen,Mode=TwoWay,RelativeSource={RelativeSource TemplatedParent}}" 
                                          ClickMode="Press"
                                          Background="{TemplateBinding Background}"
                                          BorderBrush="{TemplateBinding BorderBrush}"
                                          BorderThickness="{TemplateBinding BorderThickness}">
                                <ToggleButton.Template>
                                    <ControlTemplate TargetType="ToggleButton">
                                        <Border x:Name="Border" 
                                                CornerRadius="6"
                                                Background="{TemplateBinding Background}"
                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                BorderThickness="{TemplateBinding BorderThickness}">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="24"/>
                                                </Grid.ColumnDefinitions>
                                                <!-- Arrow -->
                                                <Path x:Name="Arrow" 
                                                      Grid.Column="1" 
                                                      Fill="#94a3b8"
                                                      HorizontalAlignment="Center" 
                                                      VerticalAlignment="Center" 
                                                      Data="M0,0 L4,4 L8,0"
                                                      Stroke="#94a3b8"
                                                      StrokeThickness="1.5"/>
                                            </Grid>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="true">
                                                <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource PrimaryBrush}"/>
                                                <Setter TargetName="Arrow" Property="Fill" Value="{StaticResource PrimaryBrush}"/>
                                                <Setter TargetName="Arrow" Property="Stroke" Value="{StaticResource PrimaryBrush}"/>
                                                <Setter Property="Cursor" Value="Hand"/>
                                            </Trigger>
                                            <Trigger Property="IsChecked" Value="true">
                                                <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource PrimaryBrush}"/>
                                                <Setter TargetName="Border" Property="Background" Value="#1e293b"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </ToggleButton.Template>
                            </ToggleButton>
                            
                            <ContentPresenter Name="ContentSite" 
                                              IsHitTestVisible="False" 
                                              Content="{TemplateBinding SelectionBoxItem}"
                                              ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                              ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                              Margin="12,0,24,0"
                                              VerticalAlignment="Center"
                                              HorizontalAlignment="Left"
                                              TextElement.Foreground="{StaticResource TextBrush}"/>
                            
                            <Popup Name="Popup"
                                   Placement="Bottom"
                                   IsOpen="{TemplateBinding IsDropDownOpen}"
                                   AllowsTransparency="True" 
                                   Focusable="False"
                                   PopupAnimation="Slide"
                                   VerticalOffset="4">
                                <Grid Name="DropDown"
                                      SnapsToDevicePixels="True"
                                      MinWidth="{TemplateBinding ActualWidth}"
                                      MaxHeight="{TemplateBinding MaxDropDownHeight}">
                                    <Border x:Name="DropDownBorder"
                                            Background="#1e293b"
                                            BorderThickness="1"
                                            BorderBrush="#33ffffff"
                                            CornerRadius="6"
                                            Margin="0,0,8,8">
                                        <Border.Effect>
                                            <DropShadowEffect Color="Black" BlurRadius="10" Opacity="0.4" ShadowDepth="4"/>
                                        </Border.Effect>
                                        <ScrollViewer Margin="0,4" SnapsToDevicePixels="True">
                                            <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained" />
                                        </ScrollViewer>
                                    </Border>
                                </Grid>
                            </Popup>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
         </Style>
         
         <!-- Modern ScrollBar Style -->
         <Style TargetType="ScrollBar">
             <Setter Property="Background" Value="Transparent"/>
             <Setter Property="Template">
                 <Setter.Value>
                     <ControlTemplate TargetType="ScrollBar">
                         <Grid>
                             <!-- Vertical ScrollBar -->
                             <Grid x:Name="VerticalRoot" Visibility="Collapsed">
                                 <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="Auto"/>
                                 </Grid.RowDefinitions>
                                 
                                 <!-- Up Button (hidden) -->
                                 <RepeatButton Grid.Row="0" Height="0" Command="ScrollBar.LineUpCommand" Opacity="0"/>
                                 
                                 <!-- Track -->
                                 <Track Grid.Row="1" x:Name="PART_Track" IsDirectionReversed="True" Width="8" Margin="0,4">
                                     <Track.Thumb>
                                         <Thumb>
                                             <Thumb.Template>
                                                 <ControlTemplate>
                                                     <Border Background="#334155" CornerRadius="4">
                                                         <Border.Style>
                                                             <Style TargetType="Border">
                                                                 <Style.Triggers>
                                                                     <Trigger Property="IsMouseOver" Value="True">
                                                                         <Setter Property="Background" Value="#475569"/>
                                                                     </Trigger>
                                                                 </Style.Triggers>
                                                             </Style>
                                                         </Border.Style>
                                                     </Border>
                                                 </ControlTemplate>
                                             </Thumb.Template>
                                         </Thumb>
                                     </Track.Thumb>
                                 </Track>
                                 
                                 <!-- Down Button (hidden) -->
                                 <RepeatButton Grid.Row="2" Height="0" Command="ScrollBar.LineDownCommand" Opacity="0"/>
                             </Grid>
                             
                             <!-- Horizontal ScrollBar (completely hidden) -->
                             <Grid x:Name="HorizontalRoot" Visibility="Collapsed" Height="0" Opacity="0"/>
                         </Grid>
                         
                         <ControlTemplate.Triggers>
                             <Trigger Property="Orientation" Value="Vertical">
                                 <Setter TargetName="VerticalRoot" Property="Visibility" Value="Visible"/>
                             </Trigger>
                             <Trigger Property="Orientation" Value="Horizontal">
                                 <Setter TargetName="HorizontalRoot" Property="Visibility" Value="Collapsed"/>
                             </Trigger>
                         </ControlTemplate.Triggers>
                     </ControlTemplate>
                 </Setter.Value>
             </Setter>
         </Style>
         
         <!-- ListBox Style - Disable Horizontal Scroll -->
         <Style TargetType="ListBox">
             <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Disabled"/>
             <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
             <Setter Property="ScrollViewer.CanContentScroll" Value="True"/>
             <Setter Property="VirtualizingPanel.ScrollUnit" Value="Pixel"/>
         </Style>

         <!-- Context Menu -->
         <ContextMenu x:Key="RowContextMenu">
             <MenuItem Header="Copia Hash" x:Name="CtxCopyHash"/>
             <MenuItem Header="Copia Percorso" x:Name="CtxCopyPath"/>
             <Separator/>
             <MenuItem Header="Apri Cartella" x:Name="CtxOpenFolder"/>
         </ContextMenu>
         <!-- Window Control Button Styles -->
         <Style x:Key="WindowButtonStyle" TargetType="Button">
             <Setter Property="Background" Value="Transparent"/>
             <Setter Property="Foreground" Value="#cbd5e1"/>
             <Setter Property="Width" Value="46"/>
             <Setter Property="Height" Value="32"/>
             <Setter Property="Template">
                 <Setter.Value>
                     <ControlTemplate TargetType="Button">
                         <Border Background="{TemplateBinding Background}">
                             <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                         </Border>
                     </ControlTemplate>
                 </Setter.Value>
             </Setter>
             <Style.Triggers>
                 <Trigger Property="IsMouseOver" Value="True">
                     <Setter Property="Background" Value="#26ffffff"/>
                     <Setter Property="Foreground" Value="White"/>
                 </Trigger>
             </Style.Triggers>
         </Style>

         <Style x:Key="WindowCloseButtonStyle" TargetType="Button" BasedOn="{StaticResource WindowButtonStyle}">
             <Setter Property="Foreground" Value="#ff6b6b"/>
             <Style.Triggers>
                 <Trigger Property="IsMouseOver" Value="True">
                     <Setter Property="Background" Value="#e81123"/>
                     <Setter Property="Foreground" Value="White"/>
                 </Trigger>
             </Style.Triggers>
         </Style>
    </Window.Resources>

    <Border x:Name="MainBorder" Background="{StaticResource BackgroundBrush}" CornerRadius="12" BorderThickness="1" BorderBrush="#33FFFFFF">
        <Border.Style>
            <Style TargetType="Border">
                <Style.Triggers>
                    <DataTrigger Binding="{Binding WindowState, RelativeSource={RelativeSource AncestorType=Window}}" Value="Maximized">
                        <Setter Property="Margin" Value="8,8,8,60"/>
                    </DataTrigger>
                </Style.Triggers>
            </Style>
        </Border.Style>
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="32"/> <!-- Title Bar -->
                <RowDefinition Height="Auto"/> <!-- Compact Header -->
                <RowDefinition Height="*"/>  <!-- Content -->
                <RowDefinition Height="32"/> <!-- Status Bar -->
            </Grid.RowDefinitions>

            <!-- Title Bar -->
            <Grid Grid.Row="0" Background="Transparent">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Orientation="Horizontal" Margin="16,0">
                    <!-- Logo removed from title bar as requested -->
                    <TextBlock Text="Hash Forge" Foreground="{StaticResource TextBrush}" 
                               VerticalAlignment="Center" Margin="0,0,0,0" FontSize="12" FontWeight="SemiBold" Opacity="0.7"/>
                </StackPanel>

                <StackPanel Grid.Column="2" Orientation="Horizontal" WindowChrome.IsHitTestVisibleInChrome="True">
                    <Button x:Name="SettingsBtn" Style="{StaticResource WindowButtonStyle}" ToolTip="Impostazioni">
                        <Path Data="M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8M12,10A2,2 0 0,0 10,12A2,2 0 0,0 12,14A2,2 0 0,0 14,12A2,2 0 0,0 12,10M10,22C9.75,22 9.54,21.82 9.5,21.58L9.13,18.93C8.5,18.68 7.96,18.34 7.44,17.94L4.95,18.95C4.73,19.03 4.46,18.95 4.34,18.73L2.34,15.27C2.21,15.05 2.27,14.78 2.46,14.63L4.56,12.97L4.5,12L4.56,11.03L2.46,9.37C2.27,9.22 2.21,8.95 2.34,8.73L4.34,5.27C4.46,5.05 4.73,4.96 4.95,5.05L7.44,6.05C7.96,5.66 8.5,5.32 9.13,5.07L9.5,2.42C9.54,2.18 9.75,2 10,2H14C14.25,2 14.46,2.18 14.5,2.42L14.87,5.07C15.5,5.32 16.04,5.66 16.56,6.05L19.05,5.05C19.27,4.96 19.54,5.05 19.66,5.27L21.66,8.73C21.79,8.95 21.73,9.22 21.54,9.37L19.44,11.03L19.5,12L19.44,12.97L21.54,14.63C21.73,14.78 21.79,15.05 21.66,15.27L19.66,18.73C19.54,18.95 19.27,19.03 19.05,18.95L16.56,17.94C16.04,18.34 15.5,18.68 14.87,18.93L14.5,21.58C14.46,21.82 14.25,22 14,22H10Z" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}" Stretch="Uniform" Width="14" Height="14" VerticalAlignment="Center" HorizontalAlignment="Center" SnapsToDevicePixels="True"/>
                    </Button>
                    <Button x:Name="MinimizeBtn" Style="{StaticResource WindowButtonStyle}">
                        <Rectangle Width="10" Height="1" Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}" VerticalAlignment="Center" HorizontalAlignment="Center" SnapsToDevicePixels="True"/>
                    </Button>
                    <Button x:Name="MaximizeBtn" Style="{StaticResource WindowButtonStyle}">
                        <Rectangle Width="10" Height="10" Stroke="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}" StrokeThickness="1" VerticalAlignment="Center" HorizontalAlignment="Center" SnapsToDevicePixels="True"/>
                    </Button>
                    <Button x:Name="CloseBtn" Style="{StaticResource WindowCloseButtonStyle}">
                        <Path Data="M 0,0 L 10,10 M 0,10 L 10,0" Stroke="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}" StrokeThickness="1.5" VerticalAlignment="Center" HorizontalAlignment="Center" SnapsToDevicePixels="True"/>
                    </Button>
                </StackPanel>
            </Grid>

            <!-- Compact Header -->
            <Border Grid.Row="1" Margin="24,0,24,16" CornerRadius="8" Height="60">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                        <GradientStop Color="#2000c2ff" Offset="0"/>
                        <GradientStop Color="#101363ee" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <StackPanel VerticalAlignment="Center" Margin="24,0" Orientation="Horizontal">
                        <!-- Logo Image with forced high-quality decoding -->
                        <Image Width="32" Height="32" Margin="0,0,16,0" VerticalAlignment="Center" RenderOptions.BitmapScalingMode="HighQuality">
                            <Image.Source>
                                <BitmapImage UriSource="icon.png" CacheOption="OnLoad"/>
                            </Image.Source>
                            <Image.Effect>
                                <DropShadowEffect Color="#00c2ff" BlurRadius="10" Opacity="0.4" ShadowDepth="0"/>
                            </Image.Effect>
                        </Image>
                        <StackPanel VerticalAlignment="Center">
                            <TextBlock Text="Hash Forge" FontSize="20" FontWeight="Bold" Foreground="White"/>
                            <TextBlock Text="Utility per calcolo e validazione di hash (MD5, SHA, ecc.)." Foreground="#94a3b8" FontSize="12"/>
                        </StackPanel>
                    </StackPanel>
                    
                    <!-- Optional: Add some stats or info here if needed in future -->
                </Grid>
            </Border>

            <!-- Main Content -->
            <Grid Grid.Row="2" Margin="24,0,24,24">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="1*" MinWidth="300"/>
                    <ColumnDefinition Width="24"/>
                    <ColumnDefinition Width="2*" MinWidth="400"/>
                </Grid.ColumnDefinitions>

                <!-- Controls Card -->
                <Border Grid.Column="0" Background="{StaticResource CardBrush}" CornerRadius="16" BorderBrush="#1affffff" BorderThickness="1" Padding="24">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/> <!-- Header -->
                            <RowDefinition Height="Auto"/> <!-- Combos -->
                            <RowDefinition Height="Auto"/> <!-- Buttons -->
                            <RowDefinition Height="*"/>    <!-- FileList (Flexible) -->
                            <RowDefinition Height="Auto"/> <!-- Compute -->
                            <RowDefinition Height="Auto"/> <!-- Progress -->
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Text="CONTROLLI" Foreground="#94a3b8" FontSize="12" FontWeight="Bold" Margin="0,0,0,16"/>
                        
                        <Grid Grid.Row="1" Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="12"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="ALGORITMO" Foreground="#64748b" FontSize="11" Margin="0,0,0,6"/>
                                <ComboBox x:Name="AlgoCombo" SelectedIndex="3" Padding="8">
                                    <ComboBoxItem Content="MD5"/>
                                    <ComboBoxItem Content="SHA1"/>
                                    <ComboBoxItem Content="SHA224"/>
                                    <ComboBoxItem Content="SHA256"/>
                                    <ComboBoxItem Content="SHA512"/>
                                </ComboBox>
                            </StackPanel>
                            <StackPanel Grid.Column="2">
                                <TextBlock Text="HASH ATTESO (OPZIONALE)" Foreground="#64748b" FontSize="11" Margin="0,0,0,6"/>
                                <TextBox x:Name="ExpectedHashBox" Padding="8" Height="34" Background="#111a2b" Foreground="#e2e8f0" BorderBrush="#33ffffff" BorderThickness="1" VerticalContentAlignment="Center"/>
                            </StackPanel>
                        </Grid>

                        <Grid Grid.Row="2" Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="8"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="8"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Button x:Name="AddFileBtn" Grid.Column="0" Content="ðŸ“„ File" Background="{StaticResource PrimaryBrush}" Foreground="#0f172a" FontWeight="Bold" FontSize="13"/>
                            <Button x:Name="AddFolderBtn" Grid.Column="2" Content="ðŸ“ Cartella" Background="{StaticResource PrimaryBrush}" Foreground="#0f172a" FontWeight="Bold" FontSize="13"/>
                            <Button x:Name="ClearBtn" Grid.Column="4" Content="ðŸ—‘ï¸ Svuota" Background="{StaticResource DangerBrush}" Foreground="#1a0500" FontWeight="Bold" FontSize="13"/>
                        </Grid>


                        <ListBox Grid.Row="3" x:Name="FileList" Background="#0f172a" BorderThickness="0" Foreground="#e2e8f0" Margin="0,0,0,16" AllowDrop="True">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <!-- Icon -->
                                        <TextBlock Grid.Column="0" Text="ðŸ“„" FontSize="14" Margin="0,0,8,0" VerticalAlignment="Center"/>
                                        
                                        <!-- File Name -->
                                        <TextBlock Grid.Column="1" Text="{Binding}" FontSize="13" VerticalAlignment="Center" TextTrimming="CharacterEllipsis"/>
                                    </Grid>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                            <ListBox.ItemContainerStyle>
                                <Style TargetType="ListBoxItem">
                                    <Setter Property="Background" Value="Transparent"/>
                                    <Setter Property="Padding" Value="8,6"/>
                                    <Setter Property="Margin" Value="0,1"/>
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="ListBoxItem">
                                                <Border Background="{TemplateBinding Background}" 
                                                        Padding="{TemplateBinding Padding}"
                                                        CornerRadius="4">
                                                    <ContentPresenter/>
                                                </Border>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#1e293b"/>
                                        </Trigger>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter Property="Background" Value="#334155"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </ListBox.ItemContainerStyle>
                        </ListBox>


                        <Button Grid.Row="4" x:Name="ComputeBtn" Content="âš¡ Calcola Hash" Background="{StaticResource AccentBrush}" Foreground="#022c22" FontWeight="Bold" Height="44" FontSize="15">
                            <Button.Effect>
                                <DropShadowEffect Color="#34e0a1" BlurRadius="20" Opacity="0.3" ShadowDepth="0"/>
                            </Button.Effect>
                        </Button>

                        <Button Grid.Row="4" x:Name="StopBtn" Content="â›” Interrompi" Background="{StaticResource DangerBrush}" Foreground="#1a0500" FontWeight="Bold" Height="44" FontSize="15" Visibility="Collapsed">
                            <Button.Effect>
                                <DropShadowEffect Color="#ff7b00" BlurRadius="20" Opacity="0.3" ShadowDepth="0"/>
                            </Button.Effect>
                        </Button>
                        
                        <StackPanel x:Name="StatsPanel" Grid.Row="5" Visibility="Collapsed">
                            <!-- Smart Stats Grid -->
                            <UniformGrid Rows="1" Columns="4" Margin="0,24,0,8">
                                <StackPanel Margin="0,0,8,0">
                                    <TextBlock Text="FILE" FontSize="10" Foreground="#64748b" FontWeight="Bold"/>
                                    <TextBlock x:Name="StatFiles" Text="-" FontSize="13" Foreground="#e2e8f0" FontWeight="SemiBold" TextTrimming="CharacterEllipsis"/>
                                </StackPanel>
                                <StackPanel Margin="0,0,8,0">
                                    <TextBlock Text="DATI" FontSize="10" Foreground="#64748b" FontWeight="Bold"/>
                                    <TextBlock x:Name="StatData" Text="-" FontSize="13" Foreground="#e2e8f0" FontWeight="SemiBold" TextTrimming="CharacterEllipsis"/>
                                </StackPanel>
                                <StackPanel Margin="0,0,8,0">
                                    <TextBlock Text="VELOCITÃ€" FontSize="10" Foreground="#64748b" FontWeight="Bold"/>
                                    <TextBlock x:Name="StatSpeed" Text="-" FontSize="13" Foreground="#e2e8f0" FontWeight="SemiBold" TextTrimming="CharacterEllipsis"/>
                                </StackPanel>
                                <StackPanel>
                                    <TextBlock Text="STIMA" FontSize="10" Foreground="#64748b" FontWeight="Bold"/>
                                    <TextBlock x:Name="StatETA" Text="-" FontSize="13" Foreground="#e2e8f0" FontWeight="SemiBold" TextTrimming="CharacterEllipsis"/>
                                </StackPanel>
                            </UniformGrid>

                            <!-- Pro Progress Bar -->
                            <Border Height="10" CornerRadius="5" Background="#1e293b" ClipToBounds="True">
                                <ProgressBar x:Name="Progress" Background="Transparent" BorderThickness="0" Foreground="{StaticResource PrimaryBrush}" Value="0" Maximum="100"/>
                            </Border>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- Results Card -->
                <Border Grid.Column="2" Background="{StaticResource CardBrush}" CornerRadius="16" BorderBrush="#1affffff" BorderThickness="1" Padding="24">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,16">
                            <TextBlock Text="RISULTATI" Foreground="#94a3b8" FontSize="12" FontWeight="Bold" VerticalAlignment="Center"/>
                            <Button x:Name="CopyBtn" Content="ðŸ“‹ Copia" Margin="16,0,0,0" Padding="12,6" FontSize="12" Background="#26ffffff" BorderBrush="#33ffffff" BorderThickness="1"/>
                            <Button x:Name="ExportBtn" Content="ðŸ’¾ Esporta TXT" Margin="8,0,0,0" Padding="12,6" FontSize="12" Background="#26ffffff" BorderBrush="#33ffffff" BorderThickness="1"/>
                        </StackPanel>

                        <DataGrid x:Name="ResultsGrid" Grid.Row="1" Background="Transparent" BorderThickness="0" 
                                  HeadersVisibility="Column" GridLinesVisibility="Horizontal"
                                  AutoGenerateColumns="False" IsReadOnly="True"
                                  HorizontalGridLinesBrush="#1affffff" RowBackground="Transparent"
                                  Foreground="#e2e8f0">
                            <DataGrid.Resources>
                                <Style TargetType="DataGridColumnHeader">
                                    <Setter Property="Background" Value="Transparent"/>
                                    <Setter Property="Foreground" Value="#94a3b8"/>
                                    <Setter Property="Padding" Value="8"/>
                                    <Setter Property="BorderThickness" Value="0,0,0,1"/>
                                    <Setter Property="BorderBrush" Value="#1affffff"/>
                                </Style>
                                <Style TargetType="DataGridCell">
                                    <Setter Property="Padding" Value="8"/>
                                    <Setter Property="BorderThickness" Value="0"/>
                                    <Setter Property="Background" Value="Transparent"/>
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="DataGridCell">
                                                <Border Padding="{TemplateBinding Padding}" Background="Transparent" SnapsToDevicePixels="True">
                                                    <ContentPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                                                </Border>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                    <Style.Triggers>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter Property="Background" Value="Transparent"/>
                                            <Setter Property="Foreground" Value="White"/>
                                            <Setter Property="BorderThickness" Value="0"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                                <Style TargetType="DataGridRow">
                                    <Setter Property="Background" Value="Transparent"/>
                                    <Setter Property="Margin" Value="0,1"/>
                                    <Setter Property="ContextMenu" Value="{StaticResource RowContextMenu}"/>
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="DataGridRow">
                                                <Border x:Name="DGR_Border"
                                                        Background="{TemplateBinding Background}"
                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                        CornerRadius="4"
                                                        SnapsToDevicePixels="True">
                                                    <DataGridCellsPresenter ItemsPanel="{TemplateBinding ItemsPanel}" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter TargetName="DGR_Border" Property="Background" Value="#1e293b"/>
                                                    </Trigger>
                                                    <Trigger Property="IsSelected" Value="True">
                                                        <Setter TargetName="DGR_Border" Property="Background" Value="#334155"/>
                                                        <Setter Property="Foreground" Value="White"/>
                                                    </Trigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </DataGrid.Resources>
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="FILE" Binding="{Binding Name}" Width="2*" Foreground="White"/>
                                <DataGridTextColumn Header="ALGORITMO" Binding="{Binding Algorithm}" Width="Auto" Foreground="#94a3b8"/>
                                <DataGridTextColumn Header="HASH" Binding="{Binding Hash}" Width="3*" Foreground="#cbd5e1">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="FontFamily" Value="Consolas"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="DIMENSIONE" Binding="{Binding Size}" Width="Auto" Foreground="#94a3b8"/>
                                
                                <!-- Status Column -->
                                <DataGridTemplateColumn x:Name="StatusColumn" Header="STATUS" Width="Auto" Visibility="Collapsed">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock FontWeight="Bold" HorizontalAlignment="Center">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="Text" Value=""/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding MatchStatus}" Value="True">
                                                                <Setter Property="Text" Value="âœ… OK"/>
                                                                <Setter Property="Foreground" Value="#4ade80"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding MatchStatus}" Value="False">
                                                                <Setter Property="Text" Value="âŒ NO"/>
                                                                <Setter Property="Foreground" Value="#f87171"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Border>
            </Grid>

            <!-- Status Bar -->
            <Border Grid.Row="3" Background="#0f172a" BorderThickness="0,1,0,0" BorderBrush="#1affffff">
                <TextBlock x:Name="StatusBarText" Text="Pronto" Foreground="#64748b" VerticalAlignment="Center" Margin="16,0" FontSize="12"/>
            </Border>

            <!-- Settings Modal Overlay -->
            <Grid x:Name="SettingsOverlay" Grid.RowSpan="4" Background="#AA000000" Visibility="Collapsed" Panel.ZIndex="1000">
                <Border Width="400" Height="350" Background="#1e293b" CornerRadius="12" BorderBrush="#33ffffff" BorderThickness="1" VerticalAlignment="Center" HorizontalAlignment="Center">
                    <Grid Margin="24">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <!-- Header -->
                        <TextBlock Text="Impostazioni" FontSize="20" FontWeight="Bold" Foreground="White" Margin="0,0,0,24"/>
                        
                        <!-- Content -->
                        <StackPanel Grid.Row="1">
                            <!-- Default Algo -->
                            <TextBlock Text="Algoritmo Predefinito" Foreground="#94a3b8" FontSize="12" Margin="0,0,0,8"/>
                            <ComboBox x:Name="SettingsAlgoCombo" Padding="8" Margin="0,0,0,24">
                                <ComboBoxItem Content="MD5"/>
                                <ComboBoxItem Content="SHA1"/>
                                <ComboBoxItem Content="SHA256"/>
                                <ComboBoxItem Content="SHA512"/>
                            </ComboBox>

                            <!-- Shell Integration -->
                            <TextBlock Text="Integrazione Windows" Foreground="#94a3b8" FontSize="12" Margin="0,0,0,8"/>
                            <TextBlock Text="Aggiungi 'Hash Forge' al menu tasto destro" Foreground="#64748b" FontSize="11" Margin="0,0,0,12" TextWrapping="Wrap"/>
                            <Button x:Name="ToggleContextBtn" Content="Aggiungi al Menu Contestuale" Height="36" Background="#334155" Foreground="White" BorderThickness="0"/>
                            <TextBlock x:Name="ContextStatusText" Text="" Foreground="#4ade80" FontSize="11" Margin="0,8,0,0" HorizontalAlignment="Center"/>
                        </StackPanel>

                        <!-- Footer -->
                        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,24,0,0">
                            <Button x:Name="CloseSettingsBtn" Content="Chiudi" Width="100" Height="36" Background="{StaticResource PrimaryBrush}" Foreground="#0f172a" FontWeight="Bold"/>
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>
        </Grid>
    </Border>
</Window>
